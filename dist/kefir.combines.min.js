!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.kefir||(e.kefir={})).combines=n()}}(function(){return function n(e,t,r){function i(u,o){if(!t[u]){if(!e[u]){var l="function"==typeof require&&require;if(!o&&l)return l(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var s=t[u]={exports:{}};e[u][0].call(s.exports,function(n){var t=e[u][1][n];return i(t?t:n)},s,s.exports,n,e,t,r)}return t[u].exports}for(var a="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(n,e,t){"use strict";function r(n,e){if(n instanceof b.Observable)e(n);else{var t=n&&n.constructor;if(t===Array)for(var i=0,a=n.length;i<a;++i)r(n[i],e);else if(t===Object)for(var u in n)r(n[u],e)}}function i(n){for(var e=0,t=0,r=n.length;t<r;++t)e+=o(n[t]);return e}function a(n){var e=0;for(var t in n)e+=o(n[t]);return e}function u(n){if(n){var e=n.constructor;if(e===Array)return i(n);if(e===Object)return a(n)}return 0}function o(n){return n instanceof b.Observable?1:u(n)}function l(n,e,t){var i=-1;r(n,function(n){var r=function n(e){return t._handleAny(n,e)};e[++i]=r,n.onAny(r)})}function f(n,e){var t=-1;r(n,function(n){var r=e[++t];r&&n.offAny(r)})}function s(n,e,t){if(n instanceof b.Observable)return e[++t.index];var r=n&&n.constructor;if(r===Array){for(var i=n.length,a=Array(i),u=0;u<i;++u)a[u]=s(n[u],e,t);return a}if(r===Object){var o={};for(var l in n)o[l]=s(n[l],e,t);return o}return n}function h(n){if(!(n instanceof Array))return n;var e=n.length-1,t=n[e];return t instanceof Function?t.apply(void 0,n.slice(0,e)):n}function c(){b.Property.call(this)}function v(n,e){c.call(this),this._template=n,this._handlers=e,this._values=null}function _(n){c.call(this),this._template=n,this._handler=null}function d(n,e){c.call(this),this._observable=n,this._fn=e,this._handler=null}function y(n){var e=n.length;switch(e){case 0:return n;case 1:return m(n);default:return(0,p.arityN)(e,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;++r)t[r]=arguments[r];var a=i(t);return 0===a?n.apply(null,t):(t.push(n),1===a&&new _(t),new v(t,a))})}}Object.defineProperty(t,"__esModule",{value:!0}),t.lift1=t.lift1Shallow=void 0,t.lift=y,t.default=function(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=i(e);switch(r){case 0:return h(e);case 1:return 2===e.length&&e[0]instanceof b.Observable&&e[1]instanceof Function?new d(e[0],e[1]):new _(e);default:return new v(e,r)}};var b=n("kefir"),p=n("infestines");(0,p.inherit)(c,b.Property,{_maybeEmitValue:function(n){var e=this._currentEvent;e&&(0,p.identicalU)(e.value,n)||this._emitValue(n)}}),(0,p.inherit)(v,c,{_onActivation:function(){for(var n=this._template,e=this._handlers,t=Array(e),r=Array(e),i=0;i<e;++i)r[i]=this,t[i]=this;this._handlers=t,this._values=r,l(n,t,this)},_handleAny:function(n,e){for(var t=this._handlers,r=0;t[r]!==n;)++r;switch(e.type){case"value":var i=this._values;i[r]=e.value;for(var a=0,u=i.length;a<u;++a)if(i[a]===this)return;this._maybeEmitValue(h(s(this._template,i,{index:-1})));break;case"error":this._emitError(e.value);break;default:t[r]=null;for(var o=0,l=t.length;o<l;++o)if(t[o])return;this._handlers=t.length,this._values=null,this._emitEnd()}},_onDeactivation:function(){var n=this._handlers;this._handlers=n.length,this._values=null,f(this._template,n)}}),(0,p.inherit)(_,c,{_onActivation:function(){var n=this,e=function(e){return n._handleAny(e)};this._handler=e,r(this._template,function(n){return n.onAny(e)})},_handleAny:function(n){switch(n.type){case"value":this._maybeEmitValue(h(s(this._template,[n.value],{index:-1})));break;case"error":this._emitError(n.value);break;default:this._handler=null,this._emitEnd()}},_onDeactivation:function(){var n=this._handler;this._handler=null,r(this._template,function(e){return e.offAny(n)})}}),(0,p.inherit)(d,c,{_onActivation:function(){var n=this,e=function(e){return n._handleAny(e)};this._handler=e,this._observable.onAny(e)},_handleAny:function(n){switch(n.type){case"value":this._maybeEmitValue(this._fn(n.value));break;case"error":this._emitError(n.value);break;default:this._handler=null,this._emitEnd()}},_onDeactivation:function(){var n=this._handler,e=this._observable;this._handler=null,e.offAny(n)}});var m=(t.lift1Shallow=function(n){return function(e){return e instanceof b.Observable?new d(e,n):n(e)}},t.lift1=function(n){return function(e){if(e instanceof b.Observable)return new d(e,n);var t=u(e);return 0===t?n(e):1===t?new _([e,n]):new v([e,n],t)}})},{infestines:void 0,kefir:void 0}]},{},[1])(1)});
