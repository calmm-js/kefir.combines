!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.kefir||(e.kefir={})).combines=n()}}(function(){return function n(e,t,r){function i(l,o){if(!t[l]){if(!e[l]){var u="function"==typeof require&&require;if(!o&&u)return u(l,!0);if(a)return a(l,!0);var s=new Error("Cannot find module '"+l+"'");throw s.code="MODULE_NOT_FOUND",s}var f=t[l]={exports:{}};e[l][0].call(f.exports,function(n){var t=e[l][1][n];return i(t||n)},f,f.exports,n,e,t,r)}return t[l].exports}for(var a="function"==typeof require&&require,l=0;l<r.length;l++)i(r[l]);return i}({1:[function(n,e,t){"use strict";function r(n,e){if(n instanceof b.Observable)e(n);else if((0,p.isArray)(n))for(var t=0,i=n.length;t<i;++t)r(n[t],e);else if((0,p.isObject)(n))for(var a in n)r(n[a],e)}function i(n){for(var e=0,t=0,r=n.length;t<r;++t)e+=o(n[t]);return e}function a(n){var e=0;for(var t in n)e+=o(n[t]);return e}function l(n){return(0,p.isArray)(n)?i(n):(0,p.isObject)(n)?a(n):0}function o(n){return n instanceof b.Observable?1:l(n)}function u(n,e,t){var i=-1;r(n,function(n){var r=function n(e){return t._handleAny(n,e)};e[++i]=r,n.onAny(r)})}function s(n,e){var t=-1;r(n,function(n){var r=e[++t];r&&n.offAny(r)})}function f(n,e,t){if(n instanceof b.Observable)return e[++t.index];if((0,p.isArray)(n)){for(var r=n.length,i=n,a=0;a<r;++a){var l=f(n[a],e,t);(0,p.identicalU)(i[a],l)||(i===n&&(i=n.slice(0)),i[a]=l)}return i}if((0,p.isObject)(n)){var o=n;for(var u in n){var s=f(n[u],e,t);(0,p.identicalU)(o[u],s)||(o===n&&(o=(0,p.assocPartialU)(void 0,void 0,n)),o[u]=s)}return o}return n}function h(n){if(!(n instanceof Array))return n;var e=n.length-1,t=n[e];return t instanceof Function?t.apply(void 0,n.slice(0,e)):n}function c(){b.Property.call(this)}function v(n,e){c.call(this),this._template=n,this._handlers=e,this._values=null}function d(n){c.call(this),this._template=n,this._handler=null}function _(n,e){c.call(this),this._observable=n,this._fn=e,this._handler=null}function y(n){var e=n.length;switch(e){case 0:return n;case 1:return m(n);default:return(0,p.arityN)(e,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;++r)t[r]=arguments[r];var a=i(t);return 0===a?n.apply(null,t):(t.push(n),1===a&&new d(t),new v(t,a))})}}Object.defineProperty(t,"__esModule",{value:!0}),t.lift1=t.lift1Shallow=void 0,t.lift=y,t.default=function(){for(var n=arguments.length,e=Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=i(e);switch(r){case 0:return h(e);case 1:return 2===e.length&&e[0]instanceof b.Observable&&e[1]instanceof Function?new _(e[0],e[1]):new d(e);default:return new v(e,r)}};var b=n("kefir"),p=n("infestines");(0,p.inherit)(c,b.Property,{_maybeEmitValue:function(n){var e=this._currentEvent;e&&(0,p.identicalU)(e.value,n)||this._emitValue(n)}}),(0,p.inherit)(v,c,{_onActivation:function(){for(var n=this._template,e=this._handlers,t=Array(e),r=Array(e),i=0;i<e;++i)r[i]=this,t[i]=this;this._handlers=t,this._values=r,u(n,t,this)},_handleAny:function(n,e){for(var t=this._handlers,r=0;t[r]!==n;)++r;switch(e.type){case"value":var i=this._values;i[r]=e.value;for(var a=0,l=i.length;a<l;++a)if(i[a]===this)return;this._maybeEmitValue(h(f(this._template,i,{index:-1})));break;case"error":this._emitError(e.value);break;default:t[r]=null;for(var o=0,u=t.length;o<u;++o)if(t[o])return;this._handlers=t.length,this._values=null,this._emitEnd()}},_onDeactivation:function(){var n=this._handlers;this._handlers=n.length,this._values=null,s(this._template,n)}}),(0,p.inherit)(d,c,{_onActivation:function(){var n=this,e=function(e){return n._handleAny(e)};this._handler=e,r(this._template,function(n){return n.onAny(e)})},_handleAny:function(n){switch(n.type){case"value":this._maybeEmitValue(h(f(this._template,[n.value],{index:-1})));break;case"error":this._emitError(n.value);break;default:this._handler=null,this._emitEnd()}},_onDeactivation:function(){var n=this._handler;this._handler=null,r(this._template,function(e){return e.offAny(n)})}}),(0,p.inherit)(_,c,{_onActivation:function(){var n=this,e=function(e){return n._handleAny(e)};this._handler=e,this._observable.onAny(e)},_handleAny:function(n){switch(n.type){case"value":this._maybeEmitValue(this._fn(n.value));break;case"error":this._emitError(n.value);break;default:this._handler=null,this._emitEnd()}},_onDeactivation:function(){var n=this._handler,e=this._observable;this._handler=null,e.offAny(n)}});var m=(t.lift1Shallow=function(n){return function(e){return e instanceof b.Observable?new _(e,n):n(e)}},t.lift1=function(n){return function(e){if(e instanceof b.Observable)return new _(e,n);var t=l(e);return 0===t?n(e):1===t?new d([e,n]):new v([e,n],t)}})},{infestines:void 0,kefir:void 0}]},{},[1])(1)});
